{"ast":null,"code":"var _jsxFileName = \"F:\\\\360Downloads\\\\vs2019\\\\Microsoft VS Code\\\\juejin\\\\juejin-react\\\\src\\\\componments\\\\InfiniteScroll\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport ApiArt from '../ApiArt';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst THRESHOLD = 15;\n\nconst SlidingWindowScrollHook = props => {\n  _s();\n\n  const [start, setStart] = useState(0);\n  const [llist, setLlist] = useState([{\n    id: 1\n  }, {\n    id: 2\n  }, {\n    id: 3\n  }, {\n    id: 4\n  }, {\n    id: 5\n  }, {\n    id: 6\n  }, {\n    id: 7\n  }, {\n    id: 8\n  }, {\n    id: 9\n  }, {\n    id: 10\n  }, {\n    id: 11\n  }, {\n    id: 12\n  }, {\n    id: 13\n  }, {\n    id: 14\n  }, {\n    id: 15\n  }]);\n  const [end, setEnd] = useState(THRESHOLD); // const [observer, setObserver] = useState(null);\n\n  const [scrollHeight, setScrollHeight] = useState({});\n  const [more, setMore] = useState(0);\n  const [num, setNum] = useState(0);\n  const {\n    showcate2\n  } = props;\n  const $bottomElement = useRef();\n  const $topElement = useRef();\n\n  const ScollPostion = () => {\n    var t; // , l, w, h\n\n    if (document.documentElement && document.documentElement.scrollTop) {\n      t = document.documentElement.scrollTop; // l = document.documentElement.scrollLeft\n      // w = document.documentElement.scrollWidth\n      // h = document.documentElement.scrollHeight\n    } else if (document.body) {\n      t = document.body.scrollTop; // l = document.body.scrollLeft\n      // w = document.body.scrollWidth\n      // h = document.body.scrollHeight\n    }\n\n    return {\n      top: t // left: l,\n      // width: w,\n      // height: h,\n\n    };\n  };\n\n  useEffect(() => {\n    window.addEventListener('scroll', e => {\n      console.log('滑动距离为：'); // const timer = setTimeout((_) => {\n\n      const postion = ScollPostion();\n      console.log('滑动距离为：', postion);\n      setScrollHeight(postion.top); // clearTimeout(timer)\n      // }, 300)\n    });\n    return () => window.removeEventListener('scroll', e => {\n      const postion = ScollPostion();\n      console.log('滑动距离为：', postion);\n      setScrollHeight(postion.top);\n    });\n  }, [end]);\n\n  const getData = num => {\n    setNum(num + 1);\n  };\n\n  const {\n    height\n  } = props;\n  const updatedList = llist.slice(0, end); // console.log(updatedList);\n\n  const lastIndex = updatedList.length - 1;\n  const listLength = 720;\n\n  if (scrollHeight > (more + 1) * 1420 * -142 * num - 420 || num > (more + 1) * 10) {\n    console.log('shuashuashua');\n    const maxStartIndex = listLength - 1 - THRESHOLD; // Maximum index value `start` can take\n\n    const maxEndIndex = listLength - 1; // Maximum index value `end` can take\n\n    const newEnd = end + 10 <= maxEndIndex ? end + 10 : maxEndIndex;\n    const newStart = end - 5 <= maxStartIndex ? end - 5 : maxStartIndex;\n    setLlist([...llist, {\n      id: 16 + 10 * more\n    }, {\n      id: 17 + 10 * more\n    }, {\n      id: 18 + 10 * more\n    }, {\n      id: 19 + 10 * more\n    }, {\n      id: 20 + 10 * more\n    }, {\n      id: 21 + 10 * more\n    }, {\n      id: 22 + 10 * more\n    }, {\n      id: 23 + 10 * more\n    }, {\n      id: 24 + 10 * more\n    }, {\n      id: 25 + 10 * more\n    }]);\n    setMore(more + 1);\n    setStart(newStart);\n    setEnd(newEnd);\n  } // Scroll up\n  // if ( scrollHeight> 1500 ) {\n  //   const newEnd = end === THRESHOLD ? THRESHOLD : (end - 10 > THRESHOLD ? end - 10 : THRESHOLD);\n  //   let newStart = start === 0 ? 0 : (start - 10 > 0 ? start - 10 : 0);\n  //   setStart(newStart)\n  //   setEnd(newEnd)\n  // }\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'relative'\n    },\n    children: updatedList.map((item, index) => {\n      const top = height * (index + start) + 'px'; // const id = item.id === 1 ? 'top' : (item.id === lastIndex ? 'bottom' : '');\n\n      return (\n        /*#__PURE__*/\n        // <li className=\"li-card\" key={item.key} style={{top}} ref={refVal} id={id}>{item.value}</li>\n        // console.log(item.id-1)\n        _jsxDEV(ApiArt, {\n          getData: getData.bind(num),\n          num: num,\n          showcate2: showcate2,\n          iitem: item.id - 1,\n          style: {\n            top\n          },\n          limit: item.id,\n          id: item.id\n        }, item.id - 1, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)\n      );\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SlidingWindowScrollHook, \"4FHIh4gPnp1sraDcW0ZtOq6mN7g=\");\n\n_c = SlidingWindowScrollHook;\nexport { SlidingWindowScrollHook };\n\nvar _c;\n\n$RefreshReg$(_c, \"SlidingWindowScrollHook\");","map":{"version":3,"sources":["F:/360Downloads/vs2019/Microsoft VS Code/juejin/juejin-react/src/componments/InfiniteScroll/index.js"],"names":["React","useState","useEffect","useRef","ApiArt","THRESHOLD","SlidingWindowScrollHook","props","start","setStart","llist","setLlist","id","end","setEnd","scrollHeight","setScrollHeight","more","setMore","num","setNum","showcate2","$bottomElement","$topElement","ScollPostion","t","document","documentElement","scrollTop","body","top","window","addEventListener","e","console","log","postion","removeEventListener","getData","height","updatedList","slice","lastIndex","length","listLength","maxStartIndex","maxEndIndex","newEnd","newStart","position","map","item","index","bind"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport ApiArt from '../ApiArt'\r\n\r\nconst THRESHOLD = 15;\r\n \r\nconst SlidingWindowScrollHook = (props) =>  {\r\n  const [start, setStart] = useState(0);\r\n  const [llist, setLlist] = useState([{id:1},{id:2},{id:3},{id:4},{id:5},{id:6},{id:7},{id:8},{id:9},{id:10},{id:11},{id:12},{id:13},{id:14},{id:15}]);\r\n  const [end, setEnd] = useState(THRESHOLD);\r\n  // const [observer, setObserver] = useState(null);\r\n  const [scrollHeight, setScrollHeight] = useState({});\r\n  const [more, setMore] = useState(0);\r\n  const [num, setNum] = useState(0);\r\n  const {showcate2} = props\r\n\r\n  const $bottomElement = useRef();\r\n  const $topElement = useRef();\r\n\r\n  const ScollPostion = () => {\r\n    var t\r\n    // , l, w, h\r\n\r\n    if (document.documentElement && document.documentElement.scrollTop) {\r\n      t = document.documentElement.scrollTop\r\n      // l = document.documentElement.scrollLeft\r\n      // w = document.documentElement.scrollWidth\r\n      // h = document.documentElement.scrollHeight\r\n    } else if (document.body) {\r\n      t = document.body.scrollTop\r\n      // l = document.body.scrollLeft\r\n      // w = document.body.scrollWidth\r\n      // h = document.body.scrollHeight\r\n    }\r\n    return {\r\n      top: t,\r\n      // left: l,\r\n      // width: w,\r\n      // height: h,\r\n    }\r\n  }\r\n  \r\n  useEffect(() => {\r\n    window.addEventListener('scroll', (e) => {\r\n      console.log('滑动距离为：')\r\n\r\n      // const timer = setTimeout((_) => {\r\n        const postion = ScollPostion()\r\n        console.log('滑动距离为：', postion)\r\n        setScrollHeight( postion.top )\r\n        // clearTimeout(timer)\r\n      // }, 300)\r\n    })\r\n    return () => window.removeEventListener('scroll', (e) => {const postion = ScollPostion()\r\n    console.log('滑动距离为：', postion)\r\n    setScrollHeight( postion.top )})\r\n  },[end])\r\n \r\n  const getData = (num)=>{\r\n    setNum(num+1)\r\n  }\r\n  const {height} = props;\r\n  const updatedList = llist.slice(0, end);\r\n  // console.log(updatedList);\r\n  const lastIndex = updatedList.length - 1;\r\n\r\n  const listLength = 720;\r\n  if ( scrollHeight> ( ((more+1) *1420*-142*num)-420) || num > (more+1)*10) {\r\n    console.log('shuashuashua');\r\n    const maxStartIndex = listLength - 1 - THRESHOLD;     // Maximum index value `start` can take\r\n    const maxEndIndex = listLength - 1;                   // Maximum index value `end` can take\r\n    const newEnd = (end + 10) <= maxEndIndex ? end + 10 : maxEndIndex;\r\n    const newStart = (end - 5) <= maxStartIndex ? end - 5 : maxStartIndex;\r\n    \r\n    setLlist([...llist,{id:16+10*more},{id:17+10*more},{id:18+10*more},{id:19+10*more},{id:20+10*more},{id:21+10*more},{id:22+10*more},{id:23+10*more},{id:24+10*more},{id:25+10*more}])\r\n    setMore(more+1)\r\n    setStart(newStart)\r\n    setEnd(newEnd)\r\n  }\r\n  // Scroll up\r\n  // if ( scrollHeight> 1500 ) {\r\n  //   const newEnd = end === THRESHOLD ? THRESHOLD : (end - 10 > THRESHOLD ? end - 10 : THRESHOLD);\r\n  //   let newStart = start === 0 ? 0 : (start - 10 > 0 ? start - 10 : 0);\r\n  //   setStart(newStart)\r\n  //   setEnd(newEnd)\r\n  // }\r\n  \r\n\r\n  return (\r\n    <div style={{position: 'relative'}}>\r\n      {updatedList.map((item, index) => {\r\n        const top = (height * (index + start)) + 'px';\r\n        // const id = item.id === 1 ? 'top' : (item.id === lastIndex ? 'bottom' : '');\r\n        return (\r\n            // <li className=\"li-card\" key={item.key} style={{top}} ref={refVal} id={id}>{item.value}</li>\r\n            // console.log(item.id-1)\r\n          <ApiArt getData={getData.bind(num)} num={num} showcate2={showcate2} iitem={item.id-1} key={item.id-1} style={{top}} limit={item.id} id={item.id}></ApiArt>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\nexport { SlidingWindowScrollHook };\r\n"]},"metadata":{},"sourceType":"module"}