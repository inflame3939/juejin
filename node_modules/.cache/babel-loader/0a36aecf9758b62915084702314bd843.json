{"ast":null,"code":"var _jsxFileName = \"F:\\\\360Downloads\\\\vs2019\\\\Microsoft VS Code\\\\juejin\\\\juejin-react\\\\src\\\\componments\\\\InfiniteScroll\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport ApiArt from '../ApiArt';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst THRESHOLD = 15;\n\nconst SlidingWindowScrollHook = props => {\n  _s();\n\n  const [start, setStart] = useState(0);\n  const [llist, setLlist] = useState([{\n    id: 1\n  }, {\n    id: 2\n  }, {\n    id: 3\n  }, {\n    id: 4\n  }, {\n    id: 5\n  }, {\n    id: 6\n  }, {\n    id: 7\n  }, {\n    id: 8\n  }, {\n    id: 9\n  }, {\n    id: 10\n  }, {\n    id: 11\n  }, {\n    id: 12\n  }, {\n    id: 13\n  }, {\n    id: 14\n  }, {\n    id: 15\n  }]);\n  const [end, setEnd] = useState(THRESHOLD);\n  const [scrollHeight, setScrollHeight] = useState({});\n  const [more, setMore] = useState(0);\n  const {\n    showcate,\n    categoryId1,\n    sortBy,\n    showhistory,\n    height\n  } = props;\n  const [hasmore, setHasmore] = useState(true);\n\n  const ScollPostion = () => {\n    let t;\n\n    if (document.documentElement && document.documentElement.scrollTop) {\n      t = document.documentElement.scrollTop;\n    } else if (document.body) {\n      t = document.body.scrollTop;\n    }\n\n    return {\n      top: t\n    };\n  };\n\n  useEffect(() => {\n    document.documentElement.addEventListener('touchmove', e => {\n      const timer = setTimeout(_ => {\n        const postion = ScollPostion();\n        setScrollH(postion.height);\n        setScrollHeight(postion.top);\n        clearTimeout(timer);\n      }, 300);\n    });\n  }, [end]);\n  useEffect(() => {\n    setLlist([{\n      id: 1\n    }, {\n      id: 2\n    }, {\n      id: 3\n    }, {\n      id: 4\n    }, {\n      id: 5\n    }, {\n      id: 6\n    }, {\n      id: 7\n    }, {\n      id: 8\n    }, {\n      id: 9\n    }, {\n      id: 10\n    }, {\n      id: 11\n    }, {\n      id: 12\n    }, {\n      id: 13\n    }, {\n      id: 14\n    }, {\n      id: 15\n    }]);\n    setEnd(15);\n    setMore(0);\n    setHasmore(true);\n  }, [showcate, categoryId1]);\n\n  const has_more = () => {\n    setHasmore(false);\n  };\n\n  const articleid = article_id => {\n    props.getdata4(article_id);\n  };\n\n  const listLength = 720;\n\n  if (scrollHeight > (more + 1) * 1420 - 420 && hasmore === true && !showhistory) {\n    console.log('shuashuashua', more, end, hasmore);\n    const maxStartIndex = listLength - 1 - THRESHOLD;\n    const maxEndIndex = listLength - 1;\n    const newEnd = end + 10 <= maxEndIndex ? end + 10 : maxEndIndex;\n    const newStart = end - 5 <= maxStartIndex ? end - 5 : maxStartIndex;\n    setLlist([...llist, {\n      id: 16 + 10 * more\n    }, {\n      id: 17 + 10 * more\n    }, {\n      id: 18 + 10 * more\n    }, {\n      id: 19 + 10 * more\n    }, {\n      id: 20 + 10 * more\n    }, {\n      id: 21 + 10 * more\n    }, {\n      id: 22 + 10 * more\n    }, {\n      id: 23 + 10 * more\n    }, {\n      id: 24 + 10 * more\n    }, {\n      id: 25 + 10 * more\n    }]);\n    setMore(more + 1);\n    setStart(newStart);\n    setEnd(newEnd);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'relative'\n    },\n    children: llist.map((item, index) => {\n      const top = height * (index + start) + 'px';\n      return /*#__PURE__*/_jsxDEV(ApiArt, {\n        articleid: articleid,\n        sortBy: sortBy,\n        has_more: has_more,\n        hasmore: hasmore,\n        showcate: showcate,\n        categoryId1: categoryId1,\n        iitem: item.id - 1,\n        style: {\n          top\n        },\n        limit: item.id,\n        id: item.id\n      }, item.id - 1, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SlidingWindowScrollHook, \"+TWdzNaXLMHrqAj/G/6YkKqhh0U=\");\n\n_c = SlidingWindowScrollHook;\nexport { SlidingWindowScrollHook };\n\nvar _c;\n\n$RefreshReg$(_c, \"SlidingWindowScrollHook\");","map":{"version":3,"sources":["F:/360Downloads/vs2019/Microsoft VS Code/juejin/juejin-react/src/componments/InfiniteScroll/index.js"],"names":["React","useState","useEffect","ApiArt","THRESHOLD","SlidingWindowScrollHook","props","start","setStart","llist","setLlist","id","end","setEnd","scrollHeight","setScrollHeight","more","setMore","showcate","categoryId1","sortBy","showhistory","height","hasmore","setHasmore","ScollPostion","t","document","documentElement","scrollTop","body","top","addEventListener","e","timer","setTimeout","_","postion","setScrollH","clearTimeout","has_more","articleid","article_id","getdata4","listLength","console","log","maxStartIndex","maxEndIndex","newEnd","newStart","position","map","item","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport ApiArt from '../ApiArt'\r\n\r\nconst THRESHOLD = 15;\r\n \r\nconst SlidingWindowScrollHook = (props) =>  {\r\n  const [start, setStart] = useState(0);\r\n  const [llist, setLlist] = useState([{id:1},{id:2},{id:3},{id:4},{id:5},{id:6},{id:7},{id:8},{id:9},{id:10},{id:11},{id:12},{id:13},{id:14},{id:15}]);\r\n  const [end, setEnd] = useState(THRESHOLD);\r\n  const [scrollHeight, setScrollHeight] = useState({});\r\n  const [more, setMore] = useState(0);\r\n  const { showcate , categoryId1 , sortBy , showhistory , height} = props\r\n  const [hasmore,setHasmore] = useState(true);\r\n\r\n  const ScollPostion = () => {\r\n    let t\r\n    if (document.documentElement && document.documentElement.scrollTop) {\r\n      t = document.documentElement.scrollTop\r\n    } else if (document.body) {\r\n      t = document.body.scrollTop\r\n    }\r\n    return {\r\n      top: t\r\n    }\r\n  }\r\n  \r\n  useEffect(() => {\r\n    document.documentElement.addEventListener('touchmove', (e) => {\r\n      const timer = setTimeout((_) => {\r\n        const postion = ScollPostion()\r\n        setScrollH( postion.height )\r\n        setScrollHeight( postion.top )\r\n        clearTimeout(timer)\r\n      }, 300)\r\n    })\r\n  },[end])\r\n\r\n  useEffect(()=>{\r\n    setLlist([{id:1},{id:2},{id:3},{id:4},{id:5},{id:6},{id:7},{id:8},{id:9},{id:10},{id:11},{id:12},{id:13},{id:14},{id:15}])\r\n    setEnd(15)\r\n    setMore(0)\r\n    setHasmore(true)\r\n  },[showcate,categoryId1])\r\n\r\n  const has_more=()=>{\r\n    setHasmore(false)\r\n  }\r\n  const articleid = (article_id) =>{\r\n    props.getdata4(article_id)\r\n  }\r\n  const listLength = 720;\r\n  if ( scrollHeight> (((more+1) *1420)-420)  && hasmore ===true && !showhistory ) {\r\n    console.log('shuashuashua',more,end,hasmore);\r\n    const maxStartIndex = listLength - 1 - THRESHOLD; \r\n    const maxEndIndex = listLength - 1;\r\n    const newEnd = (end + 10) <= maxEndIndex ? end + 10 : maxEndIndex;\r\n    const newStart = (end - 5) <= maxStartIndex ? end - 5 : maxStartIndex;\r\n    setLlist([...llist,{id:16+10*more},{id:17+10*more},{id:18+10*more},{id:19+10*more},{id:20+10*more},{id:21+10*more},{id:22+10*more},{id:23+10*more},{id:24+10*more},{id:25+10*more}])\r\n    setMore(more+1)\r\n    setStart(newStart)\r\n    setEnd(newEnd)\r\n  }\r\n  \r\n  return (\r\n    <div style={{position: 'relative'}}>\r\n      {llist.map((item, index) => {\r\n        const top = (height * (index + start)) + 'px';\r\n        return ( \r\n          <ApiArt articleid={articleid} sortBy={sortBy} has_more={has_more} hasmore={hasmore} showcate={showcate} categoryId1={categoryId1} iitem={item.id-1} key={item.id-1} style={{top}} limit={item.id} id={item.id}/>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\nexport { SlidingWindowScrollHook };\r\n"]},"metadata":{},"sourceType":"module"}